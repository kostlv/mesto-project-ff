(()=>{"use strict";var e={576:(e,t,n)=>{e.exports=n.p+"fc3e6875d825f899a98d.svg"}},t={};function n(o){var r=t[o];if(void 0!==r)return r.exports;var c=t[o]={exports:{}};return e[o](c,c.exports,n),c.exports}n.m=e,n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.p="",n.b=document.baseURI||self.location.href;var o={baseUrl:"https://nomoreparties.co/v1/cohort-mag-4",headers:{authorization:"2fb7f272-ddb8-4c2e-8670-b3c156258920","Content-Type":"application/json"}};function r(e,t,n,r){var c=arguments.length>4&&void 0!==arguments[4]&&arguments[4];c?c.some((function(e){return e._id===t}))&&n.classList.add("card__like-button_is-active"):n.classList.contains("card__like-button_is-active")?function(e){return fetch("".concat(o.baseUrl,"/cards/likes/").concat(e),{method:"DELETE",headers:o.headers}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}))}(e).then((function(e){r.textContent=e.likes.length,n.classList.remove("card__like-button_is-active")})):function(e){return fetch("".concat(o.baseUrl,"/cards/likes/").concat(e),{method:"PUT",headers:o.headers}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}))}(e).then((function(e){r.textContent=e.likes.length,n.classList.add("card__like-button_is-active")}))}function c(e){e.classList.add("popup_is-opened"),function(e){e.addEventListener("click",s),document.addEventListener("keydown",s)}(e)}function a(){var e=document.querySelector(".popup_is-opened");e.classList.remove("popup_is-opened"),e.removeEventListener("click",s),document.removeEventListener("keydown",s)}function s(e){var t=e.target;(t.classList.contains("popup__close")||t.classList.contains("popup")||"Escape"===e.key)&&a()}function i(e,t){var n=Array.from(e.querySelectorAll(t.inputSelector)),o=e.querySelector(t.submitButtonSelector);n.forEach((function(n){u(e,n,t),l(e,n,t)})),d(n,o,t)}function u(e,t,n){t.validity.patternMismatch?t.setCustomValidity(t.dataset.errorMessage):t.setCustomValidity(""),t.validity.valid?l(e,t,n):function(e,t,n,o){var r=e.querySelector(".".concat(t.name,"-input-error"));r.textContent=n,r.classList.add(o.errorClass),t.classList.add(o.inputErrorClass)}(e,t,t.validationMessage,n)}function l(e,t,n){var o=e.querySelector(".".concat(t.name,"-input-error"));o.textContent="",o.classList.remove(n.errorClass),t.classList.remove(n.inputErrorClass)}function d(e,t,n){!function(e){return e.some((function(e){return!e.validity.valid}))}(e)?(t.disabled=!1,t.classList.remove(n.inactiveButtonClass)):(t.disabled=!0,t.classList.add(n.inactiveButtonClass))}var p=document.querySelector(".header__logo"),f=new URL(n(576),n.b),m=document.querySelector(".profile"),_=document.querySelector(".profile__image"),v=document.querySelector(".profile__title"),h=document.querySelector(".profile__description"),y=document.querySelector(".popup_type_edit"),b=document.forms["edit-profile"],S=b.elements.name,k=b.elements.description,L=b.querySelector(".popup__button"),g=document.querySelector(".popup_type_new-card"),q=document.forms["new-place"],C=q.elements["place-name"],E=q.elements.link,x=q.querySelector(".popup__button"),j=document.querySelector(".popup_type_image"),P=j.querySelector(".popup__image"),U=j.querySelector(".popup__caption"),w=document.querySelector(".popup_type_avatar"),A=document.forms["edit-avatar"],T=A.elements.link,B=A.querySelector(".popup__button"),O=document.querySelector(".places__list"),D=document.querySelector("#card-template").content.querySelector(".places__item.card"),N={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_is-disabled",inputErrorClass:"popup__input_is-invalid",errorClass:"popup__input-error_is-active"};function I(e){e.textContent="Сохранение..."}function J(e){e.textContent="Сохранить"}function M(e,t,n,r,c,a,s,i,u,l,d){var p=arguments.length>11&&void 0!==arguments[11]&&arguments[11],f=function(e,t,n,r,c,a,s,i,u,l){var d=e.cloneNode(!0),p=d.querySelector(".card__delete-button"),f=d.querySelector(".card__image"),m=d.querySelector(".card__like-button"),_=d.querySelector(".card__likes-count");return f.src=n,f.alt=t,d.querySelector(".card__title").textContent=t,_.textContent=r,i===u?p.addEventListener("click",(function(){!function(e,t){(function(e){return fetch("".concat(o.baseUrl,"/cards/").concat(e),{method:"DELETE",headers:o.headers})})(t).then((function(){return e.remove()}))}(d,s)})):p.remove(),a(s,u,m,_,l),f.addEventListener("click",c),m.addEventListener("click",(function(){a(s,u,m,_)})),d}(t,n,r,c,a,s,i,u,l,d);p?e.prepend(f):e.append(f)}function H(e){var t=e.target;P.src=t.src,P.alt=t.alt,U.textContent=t.alt,c(j)}b.addEventListener("submit",(function(e){e.preventDefault(),I(L),function(e,t){return fetch("".concat(o.baseUrl,"/users/me"),{method:"PATCH",headers:o.headers,body:JSON.stringify({name:e,about:t})}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}))}(S.value,k.value).then((function(e){v.textContent=e.name,h.textContent=e.about,a(),J(L)})).catch((function(e){console.log(e)}))})),q.addEventListener("submit",(function(e){var t,n;e.preventDefault(),I(x),(t=C.value,n=E.value,fetch("".concat(o.baseUrl,"/cards"),{method:"POST",headers:o.headers,body:JSON.stringify({name:t,link:n})}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}))).then((function(e){M(O,D,e.name,e.link,e.likes.length,H,r,e._id,e.owner._id,e.owner._id,e.likes,!0),a(),J(x),q.reset(),i(q,N)})).catch((function(e){console.log(e)}))})),A.addEventListener("submit",(function(e){var t;e.preventDefault(),I(B),(t=T.value,console.log(t),fetch("".concat(o.baseUrl,"/users/me/avatar"),{method:"PATCH",headers:o.headers,body:JSON.stringify({avatar:t})}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}))).then((function(e){_.style.backgroundImage="url(".concat(e.avatar,")"),a(),J(B),A.reset(),i(A,N)})).catch((function(e){console.log(e)}))})),m.addEventListener("click",(function(e){var t=e.target;t.classList.contains("profile__add-button")?c(g):t.classList.contains("profile__edit-button")?(S.value=v.textContent,k.value=h.textContent,c(y),i(b,N)):t.classList.contains("profile__image")&&c(w)})),p.src=f,Promise.all([fetch("".concat(o.baseUrl,"/users/me"),{headers:o.headers}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})),fetch("".concat(o.baseUrl,"/cards"),{headers:o.headers}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}))]).then((function(e){_.style.backgroundImage="url(".concat(e[0].avatar,")"),v.textContent=e[0].name,h.textContent=e[0].about,e[1].forEach((function(t){M(O,D,t.name,t.link,t.likes.length,H,r,t._id,t.owner._id,e[0]._id,t.likes)}))})).catch((function(e){console.log(e)})),function(e){Array.from(document.querySelectorAll(e.formSelector)).forEach((function(t){!function(e,t){var n=Array.from(e.querySelectorAll(t.inputSelector)),o=e.querySelector(t.submitButtonSelector);d(n,o,t),n.forEach((function(r){r.addEventListener("input",(function(){u(e,r,t),d(n,o,t)}))}))}(t,e)}))}(N)})();