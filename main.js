(()=>{"use strict";var e={576:(e,t,n)=>{e.exports=n.p+"fc3e6875d825f899a98d.svg"}},t={};function n(o){var r=t[o];if(void 0!==r)return r.exports;var c=t[o]={exports:{}};return e[o](c,c.exports,n),c.exports}n.m=e,n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.p="",n.b=document.baseURI||self.location.href;var o={baseUrl:"https://nomoreparties.co/v1/cohort-mag-4",headers:{authorization:"2fb7f272-ddb8-4c2e-8670-b3c156258920","Content-Type":"application/json"}};function r(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}function c(e,t,n,c){var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];a?a.some((function(e){return e._id===t}))&&n.classList.add("card__like-button_is-active"):n.classList.contains("card__like-button_is-active")?function(e){return fetch("".concat(o.baseUrl,"/cards/likes/").concat(e),{method:"DELETE",headers:o.headers}).then(r)}(e).then((function(e){c.textContent=e.likes.length,n.classList.remove("card__like-button_is-active")})):function(e){return fetch("".concat(o.baseUrl,"/cards/likes/").concat(e),{method:"PUT",headers:o.headers}).then(r)}(e).then((function(e){c.textContent=e.likes.length,n.classList.add("card__like-button_is-active")}))}function a(e){e.classList.add("popup_is-opened"),function(e){e.addEventListener("click",s),document.addEventListener("keydown",s)}(e)}function i(){var e=document.querySelector(".popup_is-opened");e.classList.remove("popup_is-opened"),e.removeEventListener("click",s),document.removeEventListener("keydown",s)}function s(e){var t=e.target;(t.classList.contains("popup__close")||t.classList.contains("popup")||"Escape"===e.key)&&i()}function u(e,t){var n=Array.from(e.querySelectorAll(t.inputSelector)),o=e.querySelector(t.submitButtonSelector);n.forEach((function(n){l(e,n,t)})),d(n,o,t)}function l(e,t,n){var o=e.querySelector(".".concat(t.name,"-input-error"));o.textContent="",o.classList.remove(n.errorClass),t.classList.remove(n.inputErrorClass)}function d(e,t,n){!function(e){return e.some((function(e){return!e.validity.valid}))}(e)?(t.disabled=!1,t.classList.remove(n.inactiveButtonClass)):(t.disabled=!0,t.classList.add(n.inactiveButtonClass))}var p=document.querySelector(".header__logo"),f=new URL(n(576),n.b),m=document.querySelector(".profile__image"),_=document.querySelector(".profile__title"),v=document.querySelector(".profile__description"),h=document.querySelector(".profile__edit-button"),y=document.querySelector(".popup_type_edit"),b=document.forms["edit-profile"],S=b.elements.name,k=b.elements.description,q=b.querySelector(".popup__button"),L=document.querySelector(".profile__add-button"),g=document.querySelector(".popup_type_new-card"),C=document.forms["new-place"],E=C.elements["place-name"],x=C.elements.link,U=C.querySelector(".popup__button"),w=document.querySelector(".popup_type_image"),A=w.querySelector(".popup__image"),P=w.querySelector(".popup__caption"),T=document.querySelector(".profile__image"),B=document.querySelector(".popup_type_avatar"),O=document.forms["edit-avatar"],D=O.elements.link,j=O.querySelector(".popup__button"),N=document.querySelector(".places__list"),I=document.querySelector("#card-template").content.querySelector(".places__item.card"),J={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_is-disabled",inputErrorClass:"popup__input_is-invalid",errorClass:"popup__input-error_is-active"};function M(e){e.textContent="Сохранение..."}function H(e){e.textContent="Сохранить"}function R(e,t,n,c,a,i,s,u,l,d,p){var f=arguments.length>11&&void 0!==arguments[11]&&arguments[11],m=function(e,t,n,c,a,i,s,u,l,d){var p=e.cloneNode(!0),f=p.querySelector(".card__delete-button"),m=p.querySelector(".card__image"),_=p.querySelector(".card__like-button"),v=p.querySelector(".card__likes-count");return m.src=n,m.alt=t,p.querySelector(".card__title").textContent=t,v.textContent=c,u===l?f.addEventListener("click",(function(){!function(e,t){(function(e){return fetch("".concat(o.baseUrl,"/cards/").concat(e),{method:"DELETE",headers:o.headers}).then(r)})(t).then((function(){return e.remove()})).catch((function(e){console.log(e)}))}(p,s)})):f.remove(),i(s,l,_,v,d),m.addEventListener("click",a),_.addEventListener("click",(function(){i(s,l,_,v)})),p}(t,n,c,a,i,s,u,l,d,p);f?e.prepend(m):e.append(m)}function V(e){var t=e.target;A.src=t.src,A.alt=t.alt,P.textContent=t.alt,a(w)}b.addEventListener("submit",(function(e){e.preventDefault(),M(q),function(e,t){return fetch("".concat(o.baseUrl,"/users/me"),{method:"PATCH",headers:o.headers,body:JSON.stringify({name:e,about:t})}).then(r)}(S.value,k.value).then((function(e){_.textContent=e.name,v.textContent=e.about,i()})).catch((function(e){console.log(e)})).finally((function(){H(q)}))})),C.addEventListener("submit",(function(e){var t,n;e.preventDefault(),M(U),(t=E.value,n=x.value,fetch("".concat(o.baseUrl,"/cards"),{method:"POST",headers:o.headers,body:JSON.stringify({name:t,link:n})}).then(r)).then((function(e){R(N,I,e.name,e.link,e.likes.length,V,c,e._id,e.owner._id,e.owner._id,e.likes,!0),i(),C.reset(),u(C,J)})).catch((function(e){console.log(e)})).finally((function(){H(U)}))})),O.addEventListener("submit",(function(e){var t;e.preventDefault(),M(j),(t=D.value,fetch("".concat(o.baseUrl,"/users/me/avatar"),{method:"PATCH",headers:o.headers,body:JSON.stringify({avatar:t})}).then(r)).then((function(e){m.style.backgroundImage="url(".concat(e.avatar,")"),i(),O.reset(),u(O,J)})).catch((function(e){console.log(e)})).finally((function(){H(j)}))})),h.addEventListener("click",(function(){S.value=_.textContent,k.value=v.textContent,a(y),u(b,J)})),L.addEventListener("click",(function(){a(g)})),T.addEventListener("click",(function(){a(B)})),p.src=f,Promise.all([fetch("".concat(o.baseUrl,"/users/me"),{headers:o.headers}).then(r),fetch("".concat(o.baseUrl,"/cards"),{headers:o.headers}).then(r)]).then((function(e){m.style.backgroundImage="url(".concat(e[0].avatar,")"),_.textContent=e[0].name,v.textContent=e[0].about,e[1].forEach((function(t){R(N,I,t.name,t.link,t.likes.length,V,c,t._id,t.owner._id,e[0]._id,t.likes)}))})).catch((function(e){console.log(e)})),function(e){Array.from(document.querySelectorAll(e.formSelector)).forEach((function(t){!function(e,t){var n=Array.from(e.querySelectorAll(t.inputSelector)),o=e.querySelector(t.submitButtonSelector);d(n,o,t),n.forEach((function(r){r.addEventListener("input",(function(){!function(e,t,n){t.validity.patternMismatch?t.setCustomValidity(t.dataset.errorMessage):t.setCustomValidity(""),t.validity.valid?l(e,t,n):function(e,t,n,o){var r=e.querySelector(".".concat(t.name,"-input-error"));r.textContent=n,r.classList.add(o.errorClass),t.classList.add(o.inputErrorClass)}(e,t,t.validationMessage,n)}(e,r,t),d(n,o,t)}))}))}(t,e)}))}(J)})();